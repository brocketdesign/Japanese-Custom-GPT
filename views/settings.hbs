<div class="container">
  <div class="row justify-content-center">
    <div class="col-12 col-lg-10 col-xl-8 mx-auto">
      <h2 class="h3 mb-4 page-title d-none">{{translations.setting.pageTitle}}</h2>
      <div class="my-4">
      <!-- Tab Navigation -->
      <div class="overflow-auto">
          <ul class="nav nav-tabs flex-nowrap" id="myTab" role="tablist" style="white-space: nowrap;">
              <li class="nav-item" role="presentation">
                  <button class="nav-link active" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="true">
                      {{translations.setting.profile}}
                  </button>
              </li>
              <li class="d-none nav-item" role="presentation">
                  <button class="nav-link" id="password-tab" data-bs-toggle="tab" data-bs-target="#password" type="button" role="tab" aria-controls="password" aria-selected="false">
                      {{translations.setting.password}}
                  </button>
              </li>
              <li class="nav-item" role="presentation">
                  <button class="nav-link" id="subscription-tab" data-bs-toggle="tab" data-bs-target="#subscription" type="button" role="tab" aria-controls="subscription" aria-selected="false">
                      {{translations.setting.subscription}}
                  </button>
              </li>
              <li class="nav-item" role="presentation">
                  <button class="nav-link d-none" id="usage-tab" data-bs-toggle="tab" data-bs-target="#usage" type="button" role="tab" aria-controls="usage" aria-selected="false">
                      {{translations.setting.usage}}
                  </button>
              </li>
          </ul>
      </div>

        <!-- Tab content -->
        <div class="tab-content" id="myTabContent">
          <!-- Profile Tab -->
          <div class="tab-pane fade show active" id="profile" role="tabpanel" aria-labelledby="profile-tab">
            <!-- User Info Form -->
            <form id="user-info-form">
              <div class="row mb-3">
                <div id="profileSection" data-user-id="{{userData._id}}" class="text-center mb-4">
                  <div class="mx-auto p-auto text-center d-flex align-items-center justify-content-center position-relative">
                    <img id="profileImage" src="/img/avatar.png" alt="chat Thumbnail" class="rounded-circle" style="width: 100px; height: 100px; object-fit: cover; object-position: top; cursor: pointer;">
                    <i class="bi bi-pencil position-absolute" 
                    style="bottom: 5px; font-size: 10px; color: white; background-color: rgba(0, 0, 0, 0.5); border-radius: 50%; padding: 5px 8px;cursor:pointer;"></i>
                  </div>
                  <!-- imageModerationFlagged -->
                  <div class="alert alert-warning mt-2" role="alert" id="imageModerationFlagged" style="display: none;">
                    {{translations.setting.imageModerationFlagged}}
                  </div>
                </div>
              </div>

              <div class="mb-3 mx-3" id="thumbnailInputContainer" style="display: none;">
                <label for="profileImageInput" class="form-label">{{translations.setting.uploadThumbnail}}</label>
                <input type="file" class="form-control" id="profileImageInput" name="profileImageInput" accept="image/*">
              </div>

              <h6>{{translations.setting.userInfo}}</h6>
              <div class="mb-3">
                <label for="nickname" class="form-label">{{translations.setting.nickname}}</label>
                <input type="text" id="nickname" class="form-control" placeholder="" />
              </div>

              <div class="mb-3">
                <label for="inputEmail4" class="form-label">{{translations.setting.email}}</label>
                <input type="email" class="form-control" id="inputEmail4" placeholder="" />
              </div>

              <div class="row mb-3">
                <div class="form-group mb-3 text-start">
                    <label for="birthdate" class="form-label" style="font-size:12px">生年月日</label>
                    <input id="birthdate" type="text" class="form-control" placeholder="生年月日を選択" autocomplete="off">
                    <input type="hidden" id="birthYear" name="birthYear">
                    <input type="hidden" id="birthMonth" name="birthMonth">
                    <input type="hidden" id="birthDay" name="birthDay">
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-auto">
                  <label for="gender" class="form-label"><i class="fas fa-user"></i> {{translations.setting.gender}}:</label>
                  <select class="form-select w-auto" id="gender" name="gender">
                    <option value="female" selected>{{translations.setting.female}}</option>
                    <option value="male">{{translations.setting.male}}</option>
                  </select>
                </div>
                <div class="col-auto">
                  <!-- Language Dropdown -->
                  <label for="lang" class="form-label"><i class="fas fa-user"></i> {{translations.setting.language}}:</label>
                    <div class="dropdown">
                      <button data-user-lang="{{user.lang}}" class="btn btn-light dropdown-toggle" type="button" id="languageDropdownMenu" data-bs-toggle="dropdown" aria-expanded="false">
                          <i class="bi bi-globe2"></i>
                      </button>
                      <ul class="dropdown-menu position-absolute dropdown-menu-end" aria-labelledby="languageDropdownMenu">
                          <li><a class="dropdown-item language-select" href="#" data-lang="ja">日本語</a></li>
                          <li><a class="dropdown-item language-select" href="#" data-lang="en">English</a></li>
                          <li><a class="dropdown-item language-select" href="#" data-lang="fr">Français</a></li>
                      </ul>
                  </div>
                </div>

              </div>

              <!-- Bio textarea -->
              <div class="mb-3">
                <label for="bio" class="form-label">{{translations.setting.bio}}</label>
                <textarea class="form-control" id="bio" name="bio" rows="5" maxlength="400"></textarea>
              </div>

              <div class="col">
                <button type="submit" class="btn custom-gradient-bg">{{translations.setting.saveUserInfo}}</button>
              </div>
            </form>
          </div>

          <!-- Password Tab -->
          <div class="tab-pane fade" id="password" role="tabpanel" aria-labelledby="password-tab">
            <h6>{{translations.setting.password}}</h6>
            <form id="user-password-form">
              <div class="row mb-4">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="inputPassword4">{{translations.setting.oldPassword}}</label>
                    <input type="password" class="form-control" id="inputPassword4" />
                  </div>
                  <div class="form-group">
                    <label for="inputPassword5">{{translations.setting.newPassword}}</label>
                    <input type="password" class="form-control" id="inputPassword5" />
                  </div>
                  <div class="form-group">
                    <label for="inputPassword6">{{translations.setting.confirmPassword}}</label>
                    <input type="password" class="form-control" id="inputPassword6" />
                  </div>
                </div>
                <div class="col-md-6">
                  <p class="mb-2">{{translations.setting.requirements}}</p>
                  <p class="small text-muted mb-2">{{translations.setting.requirementsDescription}}</p>
                  <ul class="small text-muted pl-4 mb-0">
                    <li>{{translations.setting.minLength}}</li>
                    <li>{{translations.setting.specialChar}}</li>
                    <li>{{translations.setting.number}}</li>
                    <li>{{translations.setting.differentPassword}}</li>
                  </ul>
                </div>
              </div>
              <button type="submit" class="btn btn-secondary">{{translations.setting.changePassword}}</button>
            </form>
          </div>

          <!-- Subscription Tab -->
          <div class="tab-pane fade" id="subscription" role="tabpanel" aria-labelledby="subscription-tab">
            <p id="user-plan" style="display: none;"></p>
            <button id="cancel-plan" class="btn btn-outline-danger btn-sm rounded-pill" style="display: none;position: absolute; bottom: 20px;font-size: 10px;opacity: 0.5;" data-user-id="{{user._id}}">{{translations.setting.cancelSubscription}}</button>

            <!-- Day Pass Countdown Section -->
            <div id="day-pass-countdown-section" class="text-center p-3 border rounded shadow-sm mt-3" style="display: none;">
              <h4 class="mb-3"><i class="bi bi-clock-history me-2"></i>{{translations.setting.dayPassActiveTitle}}</h4>
              <p class="lead">{{translations.setting.dayPassExpiresIn}}</p>
              <div id="countdown-timer" class="display-4 fw-bold text-primary mb-3">
                <span id="hours">00</span>:<span id="minutes">00</span>:<span id="seconds">00</span>
              </div>
              <p id="day-pass-expired-message" class="text-danger mt-2" style="display: none;">
                {{translations.setting.dayPassExpired}} <br>
                <button class="btn custom-gradient-bg mt-2" onclick="loadPlanPage()">{{translations.select_plan_here}}</button>
              </p>
            </div>
            <!-- End Day Pass Countdown Section -->
          </div>

          <!-- Usage Tab -->
          <div class="tab-pane fade" id="usage" role="tabpanel" aria-labelledby="usage-tab">
            <h6>{{translations.setting.usage}}</h6>
            <div id="user-limit"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
