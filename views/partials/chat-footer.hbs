<div class="px-2 position-relative onchat-on" style="flex-grow:1;height: auto;">
<<<<<<< Updated upstream
<<<<<<< Updated upstream
<<<<<<< Updated upstream
=======
=======
>>>>>>> Stashed changes
=======
>>>>>>> Stashed changes
    <!-- Live Goals Widget - Compact Floating Design -->
    <div id="live-goals-widget" class="live-goals-floating onchat-on" style="display: none;">
        <!-- Main Toggle Button -->
        <div class="goals-toggle-btn" id="goals-toggle-btn">
            <div class="goals-summary">
                <i class="bi bi-trophy goals-trophy-icon"></i>
                <div class="goals-quick-stats">
                    <span class="goals-total-progress">0/18</span>
                    <span class="goals-next-reward">+25</span>
                </div>
            </div>
        </div>
        
        <!-- Expanded Goals Panel -->
        <div class="goals-expanded-panel" id="goals-expanded-panel">
            <div class="goals-panel-header">
                <h6 class="goals-panel-title">
                    <i class="bi bi-trophy me-1"></i>
                    Character Goals
                </h6>
                <button class="goals-close-btn" id="goals-close-btn">
                    <i class="bi bi-x"></i>
                </button>
            </div>
            
            <div class="goals-grid">
                <div class="goal-item-compact" id="goal-messages" data-reward="25">
                    <div class="goal-progress-ring">
                        <svg class="progress-ring" width="50" height="50">
                            <circle class="progress-ring-circle" 
                                    cx="25" cy="25" r="20" 
                                    fill="transparent" 
                                    stroke="#e9ecef" 
                                    stroke-width="4"/>
                            <circle class="progress-ring-progress" 
                                    cx="25" cy="25" r="20" 
                                    fill="transparent" 
                                    stroke="#007bff" 
                                    stroke-width="4"
                                    stroke-dasharray="125.6"
                                    stroke-dashoffset="125.6"/>
                        </svg>
                        <div class="goal-icon-ring">
                            <i class="bi bi-chat-dots"></i>
                        </div>
                    </div>
                    <div class="goal-details">
                        <span class="goal-count">0/10</span>
                        <span class="goal-label">Messages</span>
                        <span class="goal-reward">+25pts</span>
                    </div>
                </div>
                
                <div class="goal-item-compact" id="goal-images" data-reward="25">
                    <div class="goal-progress-ring">
                        <svg class="progress-ring" width="50" height="50">
                            <circle class="progress-ring-circle" 
                                    cx="25" cy="25" r="20" 
                                    fill="transparent" 
                                    stroke="#e9ecef" 
                                    stroke-width="4"/>
                            <circle class="progress-ring-progress" 
                                    cx="25" cy="25" r="20" 
                                    fill="transparent" 
                                    stroke="#28a745" 
                                    stroke-width="4"
                                    stroke-dasharray="125.6"
                                    stroke-dashoffset="125.6"/>
                        </svg>
                        <div class="goal-icon-ring">
                            <i class="bi bi-image"></i>
                        </div>
                    </div>
                    <div class="goal-details">
                        <span class="goal-count">0/5</span>
                        <span class="goal-label">Images</span>
                        <span class="goal-reward">+25pts</span>
                    </div>
                </div>
                
                <div class="goal-item-compact" id="goal-videos" data-reward="50">
                    <div class="goal-progress-ring">
                        <svg class="progress-ring" width="50" height="50">
                            <circle class="progress-ring-circle" 
                                    cx="25" cy="25" r="20" 
                                    fill="transparent" 
                                    stroke="#e9ecef" 
                                    stroke-width="4"/>
                            <circle class="progress-ring-progress" 
                                    cx="25" cy="25" r="20" 
                                    fill="transparent" 
                                    stroke="#dc3545" 
                                    stroke-width="4"
                                    stroke-dasharray="125.6"
                                    stroke-dashoffset="125.6"/>
                        </svg>
                        <div class="goal-icon-ring">
                            <i class="bi bi-play-circle"></i>
                        </div>
                    </div>
                    <div class="goal-details">
                        <span class="goal-count">0/3</span>
                        <span class="goal-label">Videos</span>
                        <span class="goal-reward">+50pts</span>
                    </div>
                </div>
            </div>
            
            <!-- Achievement Notifications -->
            <div class="achievement-notification" id="achievement-notification">
                <div class="achievement-content">
                    <i class="bi bi-trophy achievement-icon"></i>
                    <div class="achievement-text">
                        <div class="achievement-title">Milestone Reached!</div>
                        <div class="achievement-subtitle">+25 points earned</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

>>>>>>> Stashed changes
    <div id="chatInput" class="input-group rounded-0 rounded-bottom" style="position: absolute;bottom: 10px;left: 0;right: 0;padding: 0px 15px 5px 15px;">
        <div class="chat-toolbar-wrapper w-auto mx-auto">
            <div class="chat-toolbar-container">
                <!-- Main Toolbar -->
                <div class="chat-toolbar animate__animated animate__slideInUp">
                    <div id="toolbar-main" class="toolbar-scroll-container mx-2">
                        <button type="button" class="toolbar-btn" id="audio-play">
                            <i class="bi" id="audio-icon"></i>
                            <span class="tool-label">{{translations.toolbar.audio}}</span>
                        </button>
                        <button type="button" class="toolbar-btn" id="text-input-toggle">
                            <i class="bi bi-chat-dots"></i>
                            <span class="tool-label">{{translations.toolbar.chat}}</span>
                        </button>
                        <button type="button" class="toolbar-btn" id="showPrompts">
                            <i class="bi bi-image"></i>
                            <span class="tool-label">{{translations.toolbar.image}}</span>
                        </button>
                        <button type="button" class="toolbar-btn" id="gifts-toggle">
                            <i class="bi bi-gift"></i>
                            <span class="tool-label">{{translations.toolbar.gifts}}</span>
                        </button>
                        <button type="button" class="toolbar-btn" id="emoji-tone-btn">
                            <i class="bi bi-emoji-smile"></i>
                            <span class="tool-label">{{translations.toolbar.emojis}}</span>
                        </button>
                        <button type="button" class="toolbar-btn" id="suggestions-toggle">
                            <i class="bi bi-lightbulb"></i>
                            <span class="tool-label">{{translations.toolbar.ideas}}</span>
                        </button>
                        <button type="button" class="toolbar-btn" id="goals-toggle">
                            <i class="bi bi-trophy"></i>
                            <span class="tool-label">{{translations.toolbar.goals}}</span>
                        </button>
                        <button type="button" class="toolbar-btn" id="translation-toggle">
                            <i class="bi bi-translate"></i>
                            <span class="tool-label">{{translations.toolbar.translate}}</span>
                        </button>
                        <button type="button" class="toolbar-btn" id="show-personas-btn">
                            <i class="bi bi-person-lines-fill"></i>
                            <span class="tool-label">{{translations.toolbar.persona}}</span>
                        </button>
                        <button type="button" class="toolbar-btn reset-chat" id="reset-chat-btn" onclick="handleChatReset(this)">
                            <i class="bi bi-plus-square"></i>
                            <span class="tool-label">{{translations.toolbar.reset}}</span>
                        </button>
                        <button type="button" class="toolbar-btn settings-toggle" id="settings-toggle">
                            <i class="bi bi-gear"></i>
                            <span class="tool-label">{{translations.toolbar.settings}}</span>
                        </button>
                    </div>
                    
                    <!-- Tool Content Views -->
                    <!-- Emoji tone view -->
                    <div id="toolbar-emoji-tone" class="toolbar-content-view animate__animated" style="display: none;">
                        <button type="button" class="toolbar-back-btn">
                            <i class="bi bi-arrow-left"></i>
                        </button>
                        <div class="toolbar-title">ÈÅ∏Êäû„Éà„Éº„É≥</div>
                        <div class="emoji-scroll-container mx-2">
                            <button class="emoji-btn" data-tone="happy">üòä</button>
                            <button class="emoji-btn" data-tone="funny">üòÇ</button>
                            <button class="emoji-btn" data-tone="romantic">‚ù§Ô∏è</button>
                            <button class="emoji-btn" data-tone="serious">üßê</button>
                            <button class="emoji-btn" data-tone="sad">üò¢</button>
                            <button class="emoji-btn" data-tone="angry">üò°</button>
                            <button class="emoji-btn" data-tone="surprised">üò≤</button>
                            <button class="emoji-btn" data-tone="confused">üòï</button>
                            <button class="emoji-btn" data-tone="neutral">üòê</button>
                            <button class="emoji-btn" data-tone="excited">ü§©</button>
                            <button class="emoji-btn" data-tone="bored">üò¥</button>
                            <button class="emoji-btn" data-tone="curious">ü§î</button>
                            <button class="emoji-btn" data-tone="playful">üòú</button>
                            <button class="emoji-btn" data-tone="relaxed">üòå</button>
                            <button class="emoji-btn" data-tone="motivated">üí™</button>
                            <button class="emoji-btn" data-tone="inspired">‚ú®</button>
                            <button class="emoji-btn" data-tone="nostalgic">üòå</button>
                            <button class="emoji-btn" data-tone="hopeful">üåü</button>
                            <button class="emoji-btn" data-tone="grateful">üôè</button>
                            <button class="emoji-btn" data-tone="determined">üî•</button>
                        </div>
                    </div>
                    

                    <!-- Suggestions view -->
                    <div id="toolbar-suggestions" class="toolbar-content-view animate__animated" style="display: none;">
                        <button type="button" class="toolbar-back-btn">
                            <i class="bi bi-arrow-left"></i>
                        </button>
                        <div class="toolbar-title">{{translations.toolbar.ideas}}</div>
                        <div class="suggestions-scroll-container mx-2">
                            <!-- Suggestions will be dynamically added here -->
                        </div>
                    </div>
                    
                    <!-- Translation view -->
                    <div id="toolbar-translation" class="toolbar-content-view animate__animated" style="display: none;">
                        <button type="button" class="toolbar-back-btn">
                            <i class="bi bi-arrow-left"></i>
                        </button>
                        <div class="toolbar-title">{{translations.translate}}</div>
                        <div class="translation-scroll-container mx-2">
                            <button class="translation-btn" data-lang="en">{{translations.english}}</button>
                            <button class="translation-btn" data-lang="ja">{{translations.japanese}}</button>
                            <button class="translation-btn" data-lang="ko">{{translations.korean}}</button>
                            <button class="translation-btn" data-lang="zh">{{translations.chinese}}</button>
                            <button class="translation-btn" data-lang="fr">{{translations.french}}</button>
                            <button class="translation-btn" data-lang="de">{{translations.german}}</button>
                        </div>
                    </div>
                    
                    <!-- Text input view -->
                    <div id="toolbar-text-input" class="toolbar-content-view animate__animated" style="display: none;">
                        <button type="button" class="toolbar-back-btn">
                            <i class="bi bi-arrow-left"></i>
                        </button>
                        <div class="input-group w-100">
                            <textarea id="userMessage" class="form-control py-2 border-0 me-1" 
                            style="width: 100%;margin-bottom: 0.5em;margin-top: 0.5em;height: 50px;max-height: 80px; background-image: none; min-height: auto; padding-top: 5px !important; padding-left: 10px !important; padding-bottom: 0 !important;" 
                            placeholder="„ÉÅ„É£„ÉÉ„Éà„Åó„Çà„ÅÜ"></textarea>
                            <button id="sendImageMessage" class="btn btn-light px-3 chat-utils border-0 me-1" type="button">
                                <i class="bi bi-image"></i>
                            </button>
                            <button id="sendMessage" class="btn btn-light px-3 border-0 chat-utils" type="button">
                                <i class="bi bi-send"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

        <div id="suggestionsContainer" class="shadow" style="padding-bottom: 10vh;position: absolute; bottom: -10px; width: 95%; margin: auto; max-height: 55vh; background: rgb(255, 255, 255); overflow-y: auto; left: 0; right: 0; z-index: 10; border-radius: 15px 15px 0 0; display: none;">
            <button id="close-suggestionsContainer" class="btn shadow-0 position-absolute top-0 end-0"><i class="bi bi-x"></i></button>
            <div id="suggestionsList" class="row mx-2 my-5">
                <h4 class="text-center w-100 mt-2">{{translations.toolbar.ideas}}</h4>
                <p class="text-center text-muted w-100">{{translations.loading_suggestions}}</p>
                <div class="loading-spinner text-center mt-4">
                    <div class="spinner-border" role="status">
                        <span class="visually-hidden">{{translations.loading}}</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="personas-overlay">
            <div id="personas-container" class="shadow" style="position: absolute; bottom: -10px; width: 95%; margin: auto; max-height: 55vh; background: rgb(255, 255, 255); overflow-y: auto; left: 0; right: 0; z-index: 10; border-radius: 15px 15px 0 0; display: none;">
                <button id="close-personas-container" class="btn shadow-0 position-absolute top-0 end-0"><i class="bi bi-x"></i></button>
                <div id="personas-list" class="row mx-0 mb-5">
                    <h4 class="text-center w-100 mt-2">{{translations.personas.selectPersona}}</h4>
                    <p class="text-center text-muted w-100">{{translations.personas.selectPersona_description}}</p>
                    
                    <!-- Add Custom Persona Button -->
                    <div class="w-100 text-center mb-3">
                        <button type="button" class="btn btn-outline-primary" id="create-custom-persona-btn">
                            <i class="bi bi-plus-circle me-2"></i>
                            {{translations.personas.createCustomPersona}}
                        </button>
                    </div>
                    
                    <div id="persona-activated-counter" class="d-none text-center fw-bold my-2"></div>
                    <div class="loading-spinner text-center mt-4">
                        <div class="spinner-border" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="promptContainer" class="shadow" style="padding-bottom: 10vh;position: absolute; bottom: -10px; width: 95%; margin: auto; max-height: 55vh; background: rgb(255, 255, 255); overflow-y: auto;left: 0;right: 0;z-index: 10;border-radius: 15px 15px 0 0;display:none;">
            <button id="close-promptContainer" class="btn shadow-0 position-absolute top-0 end-0"><i class="bi bi-x"></i></button>
            <div id="promptList" class="row mx-0 mb-5">
                <h4 class="text-center w-100 mt-2">{{translations.selectPose}}</h4>
                <p class="text-center text-muted w-100">{{translations.selectPose_description}}</p>
                <!-- Prompts will be dynamically generated here -->
                {{#each promptData}}
                    <div 
                        class="prompt-card nsfw-{{eq nsfw 'on'}} col-6 col-sm-4 col-md-3 border-0 shadow-0 mb-3 position-relative d-flex justify-content-center align-items-center"
                        data-id="{{_id}}" 
                        data-nsfw="{{eq nsfw 'on'}}" 
                        data-cost="{{cost}}"
                        style="cursor:pointer;">
                        <div class="modern-prompt-container position-relative overflow-hidden">
                            <div class="prompt-image-wrapper">
                                <img 
                                    src="/img/image-placeholder-1.gif"
                                    data-src="{{image}}" 
                                    class="lazy-image prompt-image"
                                    alt="{{title}}" 
                                    loading="lazy">
                                <div class="prompt-overlay">
                                    <div class="prompt-shine"></div>
                                </div>
                            </div>
                            
                            <div class="prompt-info">
                                <div class="prompt-cost-badge">
                                    {{#if cost}}
                                        <i class="bi bi-coin prompt-coin-icon"></i>
                                        <span class="cost-amount">{{cost}}</span>
                                    {{else}}
                                        <i class="bi bi-image-fill"></i>
                                        <span class="free-label">Free</span>
                                    {{/if}}
                                </div>
                            </div>
                            
                            <div class="prompt-selection-indicator">
                                <i class="bi bi-check-circle-fill"></i>
                            </div>
                        </div>
                    </div>
                {{/each}}

            </div>
        </div>
        <div id="giftsOverlay" class="shadow" style="padding-bottom: 10vh;position: absolute; bottom: -10px; width: 95%; margin: auto; max-height: 55vh; background: rgb(255, 255, 255); overflow-y: auto; left: 0; right: 0; z-index: 10; border-radius: 15px 15px 0 0; display: none;">
            <button id="close-giftsOverlay" class="btn shadow-0 position-absolute top-0 end-0"><i class="bi bi-x"></i></button>
            <div id="giftsList" class="row mx-0 mb-5">
                <h4 class="text-center w-100 mt-2">{{translations.gifts.selectGift}}</h4>
                <p class="text-center text-muted w-100">{{translations.gifts.selectGift_description}}</p>
                <!-- Gifts will be dynamically generated here -->
                {{#each giftData}}
                    <div class="gift-card nsfw-{{eq nsfw 'on'}} col-6 col-sm-4 col-md-3 border-0 shadow-0 mb-3 position-relative d-flex justify-content-center align-items-center"
                        data-id="{{_id}}" 
                        data-nsfw="{{eq nsfw 'on'}}" 
                        data-cost="{{cost}}"
                        style="cursor:pointer;">
                        <div class="modern-gift-container position-relative overflow-hidden">
                            <div class="gift-image-wrapper">
                                <img 
                                    src="/img/image-placeholder-1.gif"
                                    data-src="{{image}}" 
                                    class="lazy-image gift-image"
                                    alt="{{title}}" 
                                    loading="lazy">
                                <div class="gift-overlay">
                                    <div class="gift-shine"></div>
                                </div>
                            </div>
                            
                            <div class="gift-info">
                                <h6 class="gift-title">{{title}}</h6>
                                <div class="gift-cost-badge">
                                    {{#if cost}}
                                        <i class="bi bi-coin gift-coin-icon"></i>
                                        <span class="cost-amount">{{cost}}</span>
                                    {{else}}
                                        <i class="bi bi-gift-fill"></i>
                                        <span class="free-label">Free</span>
                                    {{/if}}
                                </div>
                            </div>
                            
                            <div class="gift-selection-indicator">
                                <i class="bi bi-check-circle-fill"></i>
                            </div>
                        </div>
                    </div>
                {{/each}}
            </div>
        </div>

        <div id="goalsOverlay" class="shadow" style="padding-bottom: 10vh;position: absolute; bottom: -10px; width: 95%; margin: auto; max-height: 55vh; background: rgb(255, 255, 255); overflow-y: auto; left: 0; right: 0; z-index: 10; border-radius: 15px 15px 0 0; display: none;">
            <button id="close-goalsOverlay" class="btn shadow-0 position-absolute top-0 end-0"><i class="bi bi-x"></i></button>
            <div id="goalsList" class="row mx-0 mb-5">
                <h4 class="text-center w-100 mt-2">
                    <i class="bi bi-trophy text-warning me-2"></i>
                    {{translations.goals.completedGoals}}
                </h4>
                <p class="text-center text-muted w-100">{{translations.goals.completedGoals_description}}</p>
                <div class="mb-2 text-center">
                    <button id="goals-enable-toggle" class="btn btn-sm btn-outline-primary" data-enabled="true">
                        <i class="bi bi-toggle-on"></i>
                        <span class="goals-status-text">{{translations.goals.enabled}}</span>
                    </button>
                </div>
                <div id="goals-content" class="w-100 px-3">
                    <!-- Goals will be dynamically loaded here -->
                    <div class="loading-spinner text-center mt-4">
                        <div class="spinner-border" role="status">
                            <span class="visually-hidden">{{translations.loading}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Custom Persona Creation Modal -->
<div class="modal fade" id="custom-persona-modal" tabindex="-1" aria-labelledby="customPersonaModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="customPersonaModalLabel">
                    <i class="bi bi-person-plus me-2"></i>
                    {{translations.personas.createCustomPersona}}
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="custom-persona-form">
                    <div class="mb-3">
                        <label class="form-label fw-semibold" for="custom-persona-name">
                            {{translations.personas.customPersona.name}}
                        </label>
                        <input type="text" id="custom-persona-name" class="form-control" 
                               placeholder="{{translations.personas.customPersona.namePlaceholder}}" 
                               maxlength="50" required>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label fw-semibold" for="custom-persona-age">
                            {{translations.personas.customPersona.ageRange}}
                        </label>
                        <select id="custom-persona-age" class="form-select" required>
                            <option value="">{{translations.personas.customPersona.selectAge}}</option>
                            <option value="18-25">18-25</option>
                            <option value="26-35">26-35</option>
                            <option value="36-45">36-45</option>
                            <option value="46-55">46-55</option>
                            <option value="56+">56+</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label fw-semibold" for="custom-persona-description">
                            {{translations.personas.customPersona.description}}
                        </label>
                        <div class="text-muted mb-2 small">
                            {{translations.personas.customPersona.descriptionHelper}}
                        </div>
                        <textarea id="custom-persona-description" class="form-control" 
                                  rows="4" 
                                  placeholder="{{translations.personas.customPersona.descriptionPlaceholder}}" 
                                  maxlength="500" required></textarea>
                        <div class="form-text">
                            <span id="description-char-count">0</span>/500 {{translations.characters}}
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    {{translations.cancel}}
                </button>
                <button type="submit" form="custom-persona-form" class="btn btn-primary" id="custom-persona-save-btn">
                    <i class="bi bi-check-circle me-2"></i>
                    {{translations.personas.customPersona.createPersona}}
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Settings Modal -->
<div id="settings-modal-overlay" class="settings-modal-overlay">
    <div class="settings-modal">
        <div class="settings-modal-header">
            <h3 class="settings-modal-title">
                <i class="bi bi-gear me-2"></i>
                {{chatToolSettingsTranslations.title}}
            </h3>
            <button type="button" class="settings-close-btn" id="settings-close-btn">
                <i class="bi bi-x"></i>
            </button>
        </div>
        <div class="settings-modal-body">
            <div class="settings-quick-nav">
                <button type="button" class="settings-quick-nav-btn active" data-target="#image-settings">
                    <i class="bi bi-image"></i>
                    <span>{{chatToolSettingsTranslations.imageSettings}}</span>
                </button>
                <button type="button" class="settings-quick-nav-btn" data-target="#video-settings">
                    <i class="bi bi-camera-video"></i>
                    <span>{{chatToolSettingsTranslations.videoSettings}}</span>
                </button>
                <button type="button" class="settings-quick-nav-btn" data-target="#relationship-settings">
                    <i class="bi bi-heart"></i>
                    <span>{{chatToolSettingsTranslations.relationshipType}}</span>
                </button>
                <button type="button" class="settings-quick-nav-btn" data-target="#voice-settings">
                    <i class="bi bi-mic"></i>
                    <span>{{chatToolSettingsTranslations.voiceSettings}}</span>
                </button>
                <button type="button" class="settings-quick-nav-btn" data-target="#speech-settings">
                    <i class="bi bi-mic-fill"></i>
                    <span>{{speechToTextTranslations.settings.title}}</span>
                </button>
                <button type="button" class="settings-quick-nav-btn" data-target="#suggestions-settings">
                    <i class="bi bi-lightbulb"></i>
                    <span>{{chatToolSettingsTranslations.suggestionsSettings}}</span>
                </button>
                <button type="button" class="settings-quick-nav-btn" data-target="#model-settings">
                    <i class="bi bi-cpu"></i>
                    <span>{{chatToolSettingsTranslations.modelSettings}}</span>
                </button>
            </div>

            <!-- Image Settings -->
            <div class="settings-section" id="image-settings">
                <div class="settings-section-header">
                    <div class="settings-section-title">
                        <i class="bi bi-image me-2"></i>
                        {{chatToolSettingsTranslations.imageSettings}}
                    </div>
                </div>
                
                <div class="settings-field">
                    <label class="settings-label fw-semibold" for="min-images-range">
                        {{chatToolSettingsTranslations.minImagesToSend}}
                    </label>
                    <div class="settings-description text-muted mb-3">
                        {{chatToolSettingsTranslations.imageSettingsDescription}}
                    </div>
                    <div class="settings-range-container">
                        <input type="range" id="min-images-range" class="settings-range" 
                               min="1" max="5" value="1" step="1">
                        <div class="settings-range-value fw-bold" id="min-images-value">3</div>
                    </div>
                </div>
                
                <!-- Auto Merge Face Switch -->
                <div class="settings-field">
                    <div class="settings-field-header">
                        <label class="settings-label fw-semibold mb-0">
                            {{chatToolSettingsTranslations.autoMergeFace}}
                            <i class="bi bi-crown-fill premium-icon ms-1 text-warning" id="auto-merge-premium-icon" style="display: none;"></i>
                        </label>
                        <div class="settings-switch-container">
                            <label class="settings-switch">
                                <input type="checkbox" id="auto-merge-face-switch" checked>
                                <span class="settings-switch-slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="settings-description text-muted small mt-2">
                        {{chatToolSettingsTranslations.autoMergeFaceDescription}}
                    </div>
                    <div id="auto-merge-premium-indicator" class="premium-feature-indicator" style="display: none;">
                        <small class="text-warning d-block mt-2">
                            <i class="bi bi-star-fill me-1"></i> 
                            {{chatToolSettingsTranslations.autoMergeFacePremiumFeature}}
                        </small>
                    </div>
                </div>

                <!-- Auto Image Generation Switch -->
                <div class="settings-field">
                    <div class="settings-field-header">
                        <label class="settings-label fw-semibold mb-0">
                            {{chatToolSettingsTranslations.autoImageGeneration}}
                            <i class="bi bi-crown-fill premium-icon ms-1 text-warning" id="auto-image-premium-icon" style="display: none;"></i>
                        </label>
                        <div class="settings-switch-container">
                            <label class="settings-switch">
                                <input type="checkbox" id="auto-image-generation-switch" checked>
                                <span class="settings-switch-slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="settings-description text-muted small mt-2">
                        {{chatToolSettingsTranslations.autoImageGenerationDescription}}
                    </div>
                    <div id="auto-image-premium-indicator" class="premium-feature-indicator" style="display: none;">
                        <small class="text-warning d-block mt-2">
                            <i class="bi bi-star-fill me-1"></i> 
                            {{chatToolSettingsTranslations.autoImagePremiumFeature}}
                        </small>
                    </div>
                </div>
            </div>

            <!-- Video Settings -->
            <div class="settings-section" id="video-settings">
                <div class="settings-section-header">
                    <div class="settings-section-title">
                        <i class="bi bi-camera-video me-2"></i>
                        {{chatToolSettingsTranslations.videoSettings}}
                        <i class="bi bi-crown-fill premium-icon ms-2 text-warning"></i>
                    </div>
                </div>
                <div class="settings-description text-muted mb-4">
                    {{chatToolSettingsTranslations.videoSettingsDescription}}
                </div>
                <div class="settings-field">
                    <label class="settings-label fw-semibold" for="video-prompt">
                        {{chatToolSettingsTranslations.defaultVideoPrompt}}
                    </label>
                    <textarea id="video-prompt" class="settings-textarea mt-2" 
                              placeholder="{{chatToolSettingsTranslations.videoPromptPlaceholder}}"
                              disabled>{{chatToolSettingsTranslations.defaultVideoPromptText}}</textarea>
                    <div id="video-premium-indicator" class="premium-feature-indicator">
                        <small class="text-warning d-block mt-2">
                            <i class="bi bi-star-fill me-1"></i> 
                            {{chatToolSettingsTranslations.videoPremiumFeature}}
                        </small>
                    </div>
                </div>
            </div>

            <!-- Relationship Settings -->
            <div class="settings-section" id="relationship-settings">
                <div class="settings-section-header">
                    <div class="settings-section-title">
                        <i class="bi bi-heart me-2"></i>
                        {{chatToolSettingsTranslations.relationshipType}}
                    </div>
                </div>
                
                <div class="settings-subsection">
                    <h6 class="settings-subsection-title fw-semibold mb-2">
                        {{chatToolSettingsTranslations.freeRelationships}}
                    </h6>
                    <div class="settings-description text-muted mb-3">
                        {{chatToolSettingsTranslations.freeRelationshipsDescription}}
                    </div>
                    <div class="settings-tone-grid">
                        <div class="settings-tone-option selected" data-relationship="companion">
                            üòé {{chatToolSettingsTranslations.relationships.companion}}
                        </div>
                        <div class="settings-tone-option" data-relationship="friend">
                            üòä {{chatToolSettingsTranslations.relationships.friend}}
                        </div>
                        <div class="settings-tone-option" data-relationship="mentor">
                            üíº {{chatToolSettingsTranslations.relationships.mentor}}
                        </div>
                        <div class="settings-tone-option" data-relationship="assistant">
                            ü§ñ {{chatToolSettingsTranslations.relationships.assistant}}
                        </div>
                    </div>
                </div>

                <div class="settings-subsection">
                    <h6 class="settings-subsection-title fw-semibold mb-2">
                        {{chatToolSettingsTranslations.premiumRelationships}}
                        <i class="bi bi-crown-fill premium-icon ms-1 text-warning"></i>
                    </h6>
                    <div class="settings-description text-muted mb-3">
                        {{chatToolSettingsTranslations.premiumRelationshipsDescription}}
                    </div>
                    <div class="settings-tone-grid">
                        <!-- Premium NSFW Relationships -->
                        <div class="settings-tone-option premium-relationship" data-relationship="lover" data-nsfw="true">
                            üíã {{chatToolSettingsTranslations.relationships.lover}}
                            <i class="bi bi-crown-fill premium-icon text-warning"></i>
                        </div>
                        <div class="settings-tone-option premium-relationship" data-relationship="submissive" data-nsfw="true">
                            üîí {{chatToolSettingsTranslations.relationships.submissive}}
                            <i class="bi bi-crown-fill premium-icon text-warning"></i>
                        </div>
                        <div class="settings-tone-option premium-relationship" data-relationship="dominant" data-nsfw="true">
                            ‚ö° {{chatToolSettingsTranslations.relationships.dominant}}
                            <i class="bi bi-crown-fill premium-icon text-warning"></i>
                        </div>
                        <div class="settings-tone-option premium-relationship" data-relationship="playmate" data-nsfw="true">
                            üé≠ {{chatToolSettingsTranslations.relationships.playmate}}
                            <i class="bi bi-crown-fill premium-icon text-warning"></i>
                        </div>
                        <div class="settings-tone-option premium-relationship" data-relationship="intimate" data-nsfw="true">
                            üåπ {{chatToolSettingsTranslations.relationships.intimate}}
                            <i class="bi bi-crown-fill premium-icon text-warning"></i>
                        </div>
                    </div>
                    <div id="premium-relationships-indicator" class="premium-feature-indicator">
                        <small class="text-warning d-block mt-2">
                            <i class="bi bi-star-fill me-1"></i> 
                            {{chatToolSettingsTranslations.premiumRelationshipsPremiumFeature}}
                        </small>
                    </div>
                </div>
            </div>

            <!-- Voice Settings -->
            <div class="settings-section" id="voice-settings">
                <div class="settings-section-header">
                    <div class="settings-section-title">
                        <i class="bi bi-mic me-2"></i>
                        {{chatToolSettingsTranslations.voiceSettings}}
                    </div>
                </div>
                <div class="settings-description text-muted mb-4">
                    {{chatToolSettingsTranslations.voiceSettingsDescription}}
                </div>
                
                <!-- Voice Provider Switch -->
                <div class="settings-field">
                    <div class="settings-field-header">
                        <label class="settings-label fw-semibold mb-0">{{chatToolSettingsTranslations.voiceProvider}}</label>
                        <div class="settings-switch-container">
                            <span class="settings-switch-label standard-label me-2">{{chatToolSettingsTranslations.standard}}</span>
                            <label class="settings-switch">
                                <input type="checkbox" id="voice-provider-switch">
                                <span class="settings-switch-slider"></span>
                            </label>
                            <span class="settings-switch-label premium-label ms-2">
                                {{chatToolSettingsTranslations.premium}} 
                                <i class="bi bi-crown-fill premium-icon text-warning"></i>
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Standard Voices -->
                <div class="settings-field" id="standard-voices">
                    <label class="settings-label fw-semibold">{{chatToolSettingsTranslations.selectStandardVoice}}</label>
                    <div class="settings-voice-grid mt-3">
                        <div class="settings-voice-option selected" data-voice="nova">
                            <div class="settings-voice-name fw-semibold">{{chatToolSettingsTranslations.voices.nova.name}}</div>
                            <div class="settings-voice-description text-muted small">{{chatToolSettingsTranslations.voices.nova.description}}</div>
                        </div>
                        <div class="settings-voice-option" data-voice="alloy">
                            <div class="settings-voice-name fw-semibold">{{chatToolSettingsTranslations.voices.alloy.name}}</div>
                            <div class="settings-voice-description text-muted small">{{chatToolSettingsTranslations.voices.alloy.description}}</div>
                        </div>
                        <div class="settings-voice-option" data-voice="shimmer">
                            <div class="settings-voice-name fw-semibold">{{chatToolSettingsTranslations.voices.shimmer.name}}</div>
                            <div class="settings-voice-description text-muted small">{{chatToolSettingsTranslations.voices.shimmer.description}}</div>
                        </div>
                        <div class="settings-voice-option" data-voice="fable">
                            <div class="settings-voice-name fw-semibold">{{chatToolSettingsTranslations.voices.fable.name}}</div>
                            <div class="settings-voice-description text-muted small">{{chatToolSettingsTranslations.voices.fable.description}}</div>
                        </div>
                    </div>
                </div>

                <!-- Premium Voices -->
                <div class="settings-field" id="premium-voices" style="display: none;">
                    <label class="settings-label fw-semibold">
                        {{chatToolSettingsTranslations.selectPremiumVoice}}
                        <i class="bi bi-crown-fill premium-icon ms-1 text-warning"></i>
                    </label>
                    <div class="settings-voice-grid mt-3" id="premium-voices-grid">
                        <!-- Premium voices will be dynamically loaded here -->
                        <div class="voice-loading-spinner text-center py-4">
                            <div class="spinner-border spinner-border-sm text-primary" role="status">
                                <span class="visually-hidden">Loading voices...</span>
                            </div>
                            <div class="loading-text text-muted mt-2">Loading Premium voices...</div>
                        </div>
                    </div>
                    <div id="premium-voices-indicator" class="premium-feature-indicator">
                        <small class="text-warning d-block mt-2">
                            <i class="bi bi-star-fill me-1"></i> 
                            {{chatToolSettingsTranslations.premiumVoicesPremiumFeature}}
                        </small>
                    </div>
                </div>
            </div>

            <!-- Speech Recognition Settings -->
            <div class="settings-section" id="speech-settings">
                <div class="settings-section-header">
                    <div class="settings-section-title">
                        <i class="bi bi-mic-fill me-2"></i>
                        {{speechToTextTranslations.settings.title}}
                    </div>
                </div>
                <div class="settings-description text-muted mb-4">
                    {{speechToTextTranslations.settings.description}}
                </div>
                
                <!-- Enable Speech Recognition Switch -->
                <div class="settings-field">
                    <div class="settings-field-header">
                        <label class="settings-label fw-semibold mb-0">{{speechToTextTranslations.settings.enabled}}</label>
                        <div class="settings-switch-container">
                            <label class="settings-switch">
                                <input type="checkbox" id="speech-recognition-enable-switch" checked>
                                <span class="settings-switch-slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="settings-description text-muted small mt-2">
                        {{speechToTextTranslations.settings.enabledDescription}}
                    </div>
                </div>

                <!-- Auto Send Messages Switch -->
                <div class="settings-field">
                    <div class="settings-field-header">
                        <label class="settings-label fw-semibold mb-0">{{speechToTextTranslations.settings.autoSend}}</label>
                        <div class="settings-switch-container">
                            <label class="settings-switch">
                                <input type="checkbox" id="speech-auto-send-switch">
                                <span class="settings-switch-slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="settings-description text-muted small mt-2">
                        {{speechToTextTranslations.settings.autoSendDescription}}
                    </div>
                </div>

                <!-- Keyboard Shortcut Info -->
                <div class="settings-field">
                    <div class="settings-info-box">
                        <i class="bi bi-keyboard me-2"></i>
                        <span>{{speechToTextTranslations.keyboardShortcut}}</span>
                    </div>
                </div>
            </div>
            
            <!-- Chat Suggestions Settings -->
            <div class="settings-section" id="suggestions-settings">
                <div class="settings-section-header">
                    <div class="settings-section-title">
                        <i class="bi bi-lightbulb me-2"></i>
                        {{chatToolSettingsTranslations.suggestionsSettings}}
                    </div>
                </div>
                <div class="settings-description text-muted mb-4">
                    {{chatToolSettingsTranslations.suggestionsSettingsDescription}}
                </div>
                
                <!-- Enable Suggestions Switch -->
                <div class="settings-field">
                    <div class="settings-field-header">
                        <label class="settings-label fw-semibold mb-0">{{chatToolSettingsTranslations.enableSuggestions}}</label>
                        <div class="settings-switch-container">
                            <label class="settings-switch">
                                <input type="checkbox" id="suggestions-enable-switch" checked>
                                <span class="settings-switch-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Model Settings -->
            <div class="settings-section" id="model-settings">
                <div class="settings-section-header">
                    <div class="settings-section-title">
                        <i class="bi bi-cpu me-2"></i>
                        {{chatToolSettingsTranslations.modelSettings}}
                    </div>
                </div>
                <div class="settings-description text-muted mb-4">
                    {{chatToolSettingsTranslations.modelSettingsDescription}}
                </div>
                
                <!-- Dynamic Model Grid -->
                <div class="settings-field">
                    <div id="models-container">
                        <!-- Models will be dynamically loaded here -->
                        <div class="model-loading-container">
                            <div class="spinner-border model-loading-spinner" role="status">
                                <span class="visually-hidden">{{translations.loading}}</span>
                            </div>
                            <div class="mt-3">Loading AI models...</div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
        <div class="settings-chat-footer mt-4 pt-4 border-top">
            <button type="button" class="settings-save-btn" id="settings-save-btn">
                <i class="bi bi-check-circle me-2"></i>
                {{chatToolSettingsTranslations.saveSettings}}
            </button>
        </div>
    </div>
</div>

<script>

// Ensure toolbar scrolling works properly on mobile
document.addEventListener('DOMContentLoaded', function() {
    const toolbarContainer = document.getElementById('toolbar-main');
    if (toolbarContainer && window.innerWidth <= 768) {
        // Reset scroll position to start
        toolbarContainer.scrollLeft = 0;
        
        // Add touch scroll enhancement
        let isScrolling = false;
        toolbarContainer.addEventListener('touchstart', () => isScrolling = true);
        toolbarContainer.addEventListener('touchend', () => {
            setTimeout(() => isScrolling = false, 100);
        });
        
        // Prevent click events during scrolling
        toolbarContainer.addEventListener('click', (e) => {
            if (isScrolling) e.preventDefault();
        }, true);
    }
});

// Ensure proper modal management
document.addEventListener('DOMContentLoaded', function() {
    // Handle chat history click from list items
    $(document).on('click', '.user-chat-history', function() {
        const modal = bootstrap.Modal.getInstance(document.getElementById('chatHistoryModal'));
        if (modal) {
            modal.hide();
        }
    });

    // Ensure modal backdrop is properly positioned
    $('#chatHistoryModal').on('show.bs.modal', function() {
        // Force high z-index
        setTimeout(() => {
            const backdrop = document.querySelector('.modal-backdrop');
            if (backdrop) {
                backdrop.style.zIndex = '1055';
            }
            this.style.zIndex = '1060';
        }, 10);
    });

    // Clean up when modal is hidden
    $('#chatHistoryModal').on('hidden.bs.modal', function() {
        // Clear any loading states
        $('#chat-history-list').empty();
    });
});
</script>

<style>
<<<<<<< Updated upstream
<<<<<<< Updated upstream
<<<<<<< Updated upstream
=======
=======
>>>>>>> Stashed changes
=======
>>>>>>> Stashed changes
/* Live Goals Floating Widget */
.live-goals-floating {
    position: fixed;
    top: 50%;
    right: 15px;
    transform: translateY(-50%);
    z-index: 1015;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

/* Toggle Button */
.goals-toggle-btn {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 4px 20px rgba(0, 123, 255, 0.3);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border: 3px solid rgba(255, 255, 255, 0.2);
    position: relative;
    overflow: hidden;
}

.goals-toggle-btn::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    transform: rotate(45deg);
    transition: all 0.6s;
    opacity: 0;
}

.goals-toggle-btn:hover::before {
    animation: shine 1.5s infinite;
}

.goals-toggle-btn:hover {
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 6px 25px rgba(0, 123, 255, 0.4);
}

.goals-toggle-btn:active {
    transform: translateY(-50%) scale(0.95);
}

@keyframes shine {
    0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); opacity: 0; }
    50% { opacity: 1; }
    100% { transform: translateX(100%) translateY(100%) rotate(45deg); opacity: 0; }
}

.goals-summary {
    display: flex;
    flex-direction: column;
    align-items: center;
    color: white;
}

.goals-trophy-icon {
    font-size: 18px;
    margin-bottom: 2px;
    filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
}

.goals-quick-stats {
    display: flex;
    flex-direction: column;
    align-items: center;
    line-height: 1;
}

.goals-total-progress {
    font-size: 10px;
    font-weight: 700;
    opacity: 0.9;
}

.goals-next-reward {
    font-size: 8px;
    font-weight: 600;
    background: rgba(255, 193, 7, 0.9);
    color: #000;
    padding: 1px 4px;
    border-radius: 6px;
    margin-top: 1px;
}

/* Expanded Panel */
.goals-expanded-panel {
    position: absolute;
    right: 70px;
    top: 50%;
    transform: translateY(-50%);
    width: 280px;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(15px);
    border-radius: 16px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 16px;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-50%) translateX(20px) scale(0.9);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.goals-expanded-panel.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(-50%) translateX(0) scale(1);
}

.goals-panel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.goals-panel-title {
    font-size: 14px;
    font-weight: 700;
    color: #2c3e50;
    margin: 0;
}

.goals-close-btn {
    background: none;
    border: none;
    font-size: 16px;
    color: #6c757d;
    cursor: pointer;
    padding: 4px;
    border-radius: 50%;
    transition: all 0.2s ease;
}

.goals-close-btn:hover {
    background: rgba(0, 0, 0, 0.1);
    color: #495057;
}

/* Goals Grid */
.goals-grid {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.goal-item-compact {
    display: flex;
    align-items: center;
    padding: 12px;
    background: rgba(248, 249, 250, 0.8);
    border-radius: 12px;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.goal-item-compact:hover {
    background: rgba(240, 242, 245, 0.9);
    transform: translateX(4px);
}

.goal-item-compact.completed {
    background: linear-gradient(135deg, rgba(40, 167, 69, 0.15), rgba(40, 167, 69, 0.05));
    border: 1px solid rgba(40, 167, 69, 0.3);
}

.goal-item-compact.near-completion {
    background: linear-gradient(135deg, rgba(255, 193, 7, 0.15), rgba(255, 193, 7, 0.05));
    border: 1px solid rgba(255, 193, 7, 0.3);
}

/* Progress Ring */
.goal-progress-ring {
    position: relative;
    margin-right: 12px;
}

.progress-ring {
    transform: rotate(-90deg);
}

.progress-ring-progress {
    transition: stroke-dashoffset 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.goal-icon-ring {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.9);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.goal-icon-ring i {
    font-size: 12px;
    font-weight: 600;
}

#goal-messages .goal-icon-ring i {
    color: #007bff;
}

#goal-images .goal-icon-ring i {
    color: #28a745;
}

#goal-videos .goal-icon-ring i {
    color: #dc3545;
}

/* Goal Details */
.goal-details {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.goal-count {
    font-size: 14px;
    font-weight: 700;
    color: #2c3e50;
    line-height: 1.2;
}

.goal-label {
    font-size: 11px;
    font-weight: 500;
    color: #6c757d;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.goal-reward {
    font-size: 10px;
    font-weight: 600;
    color: #f39c12;
    background: linear-gradient(135deg, rgba(255, 193, 7, 0.2), rgba(255, 193, 7, 0.1));
    padding: 2px 6px;
    border-radius: 8px;
    border: 1px solid rgba(255, 193, 7, 0.3);
    align-self: flex-start;
    margin-top: 2px;
}

.goal-item-compact.completed .goal-reward {
    color: #28a745;
    background: linear-gradient(135deg, rgba(40, 167, 69, 0.2), rgba(40, 167, 69, 0.1));
    border-color: rgba(40, 167, 69, 0.3);
}

.goal-item-compact.completed .goal-count {
    color: #28a745;
}

/* Achievement Notification */
.achievement-notification {
    position: absolute;
    top: -60px;
    left: 0;
    right: 0;
    background: linear-gradient(135deg, #28a745, #20c997);
    border-radius: 12px;
    padding: 12px;
    color: white;
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px) scale(0.9);
    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    box-shadow: 0 4px 20px rgba(40, 167, 69, 0.3);
}

.achievement-notification.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0) scale(1);
}

.achievement-content {
    display: flex;
    align-items: center;
    gap: 8px;
}

.achievement-icon {
    font-size: 20px;
    animation: trophy-bounce 0.6s ease-in-out;
}

@keyframes trophy-bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-8px); }
    60% { transform: translateY(-4px); }
}

.achievement-text {
    flex: 1;
}

.achievement-title {
    font-size: 12px;
    font-weight: 700;
    line-height: 1.2;
}

.achievement-subtitle {
    font-size: 10px;
    opacity: 0.9;
    line-height: 1.2;
}

/* Updating Animation */
.goal-item-compact.updating {
    animation: goal-update-pulse 0.6s ease;
}

@keyframes goal-update-pulse {
    0% { transform: translateX(0) scale(1); }
    50% { transform: translateX(4px) scale(1.02); background: rgba(0, 123, 255, 0.1); }
    100% { transform: translateX(0) scale(1); }
}

/* Toggle Button Pulse */
.goals-toggle-btn.pulse {
    animation: button-pulse 0.6s ease;
}

@keyframes button-pulse {
    0% { transform: translateY(-50%) scale(1); box-shadow: 0 4px 20px rgba(0, 123, 255, 0.3); }
    50% { transform: translateY(-50%) scale(1.1); box-shadow: 0 6px 30px rgba(0, 123, 255, 0.5); }
    100% { transform: translateY(-50%) scale(1); box-shadow: 0 4px 20px rgba(0, 123, 255, 0.3); }
}

/* Mobile Responsiveness */
@media (max-width: 768px) {
    .live-goals-floating {
        right: 10px;
    }
    
    .goals-toggle-btn {
        width: 50px;
        height: 50px;
    }
    
    .goals-trophy-icon {
        font-size: 16px;
    }
    
    .goals-total-progress {
        font-size: 9px;
    }
    
    .goals-next-reward {
        font-size: 7px;
    }
    
    .goals-expanded-panel {
        width: 250px;
        right: 60px;
        padding: 12px;
    }
    
    .goal-item-compact {
        padding: 10px;
    }
    
    .goal-progress-ring {
        margin-right: 10px;
    }
    
    .progress-ring {
        width: 40px;
        height: 40px;
    }
    
    .progress-ring circle {
        r: 16;
        cx: 20;
        cy: 20;
    }
    
    .goal-icon-ring {
        width: 20px;
        height: 20px;
    }
    
    .goal-icon-ring i {
        font-size: 10px;
    }
    
    .goal-count {
        font-size: 12px;
    }
}

/* Dark Mode Support */
@media (prefers-color-scheme: dark) {
    .goals-expanded-panel {
        background: rgba(33, 37, 41, 0.98);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .goals-panel-title {
        color: #f8f9fa;
    }
    
    .goal-item-compact {
        background: rgba(255, 255, 255, 0.05);
    }
    
    .goal-item-compact:hover {
        background: rgba(255, 255, 255, 0.1);
    }
    
    .goal-count {
        color: #f8f9fa;
    }
    
    .goal-label {
        color: #adb5bd;
    }
    
    .goal-icon-ring {
        background: rgba(255, 255, 255, 0.1);
    }
}

>>>>>>> Stashed changes
/* Milestone Goals Styling */
.milestone-goals-grid {
    display: grid;
    gap: 1rem;
}

@media (min-width: 768px) {
    .milestone-goals-grid {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }
}

.milestone-goal-card {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 249, 250, 0.95));
    border: 2px solid rgba(13, 110, 253, 0.15) !important;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.milestone-goal-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    border-color: rgba(13, 110, 253, 0.3) !important;
}

.milestone-goal-card .progress {
    background-color: rgba(0, 0, 0, 0.1);
    border-radius: 10px;
}

.milestone-goal-card .progress-bar {
    transition: width 0.6s ease;
    border-radius: 10px;
}

.milestone-goal-card h6 {
    font-weight: 600;
    color: #2c3e50;
}

/* Completed Milestones Styling */
.milestone-card.completed {
    background: linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 255, 255, 0.9));
    border-left: 4px solid #ffc107 !important;
    transition: all 0.2s ease;
}

.milestone-card.completed:hover {
    background: linear-gradient(135deg, rgba(255, 193, 7, 0.2), rgba(255, 255, 255, 1));
    transform: translateX(3px);
}

/* Goals Section Headers */
.milestone-goals-section h5,
.completed-milestones-section h5 {
    font-weight: 700;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    font-size: 0.95rem;
}

/* Badge Styling */
.milestone-goal-card .badge {
    font-weight: 600;
    font-size: 0.75rem;
    padding: 0.4em 0.8em;
}

/* Icon Styling */
.milestone-goal-card i[class*="bi-"] {
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
}

/* Responsive Design */
@media (max-width: 767px) {
    .milestone-goals-grid {
        grid-template-columns: 1fr;
    }
    
    .milestone-goal-card {
        margin-bottom: 0.75rem;
    }
}

/* Animation for completed milestones */
.milestone-card.completed {
    animation: slideInFromLeft 0.5s ease-out;
}

@keyframes slideInFromLeft {
    0% {
        transform: translateX(-20px);
        opacity: 0;
    }
    100% {
        transform: translateX(0);
        opacity: 1;
    }
}

/* Loading animation for progress bars */
.progress-bar {
    position: relative;
}

.progress-bar::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.4),
        transparent
    );
    animation: shimmer 2s infinite;
}

@keyframes shimmer {
    0% {
        transform: translateX(-100%);
    }
    100% {
        transform: translateX(100%);
    }
}

/* Dark mode adjustments */
@media (prefers-color-scheme: dark) {
    .milestone-goal-card {
        background: linear-gradient(135deg, rgba(33, 37, 41, 0.95), rgba(52, 58, 64, 0.95));
        border-color: rgba(108, 117, 125, 0.3) !important;
    }
    
    .milestone-goal-card h6 {
        color: #f8f9fa;
    }
    
    .milestone-card.completed {
        background: linear-gradient(135deg, rgba(255, 193, 7, 0.15), rgba(33, 37, 41, 0.95));
    }
}
</style>

