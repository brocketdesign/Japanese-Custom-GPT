<!DOCTYPE html>
<html lang="{{lang}}">
{{> dashboard-header seoTitle=seoTitle seoDescription=seoDescription}}
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="/css/explore-gallery.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
</head>

<body class="explore-body">
    <!-- Hide main nav for immersive experience -->
    <style>#mainNav { display: none !important; }</style>

    <div class="explore-container" id="explorePage">
        <!-- Sticky Search & Filter Bar -->
        <div class="explore-sticky-header">
            <div class="explore-search-bar">
                <!-- Back/Home Button -->
                <a href="/" class="explore-back-btn" title="Home">
                    <i class="bi bi-house-fill"></i>
                </a>
                
                <form id="search-form" action="/search" method="GET" class="explore-search-form">
                    <div class="search-input-group">
                        <i class="bi bi-search"></i>
                        <input 
                            type="text" 
                            name="q" 
                            id="search-input" 
                            placeholder="{{translations.searchPlaceholder}}" 
                            value="{{query}}"
                            autocomplete="off"
                        >
                        {{#if query}}
                        <button type="button" class="search-clear-btn" id="clearSearch">
                            <i class="bi bi-x-lg"></i>
                        </button>
                        {{/if}}
                    </div>
                </form>
                
                <!-- NSFW Toggle -->
                <div class="nsfw-filter-toggle">
                    <button type="button" id="nsfwToggleBtn" class="nsfw-btn" data-nsfw="{{#if showNSFW}}true{{else}}false{{/if}}">
                        <i class="bi bi-shield-check"></i>
                        <span class="nsfw-label">SFW</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Explore Gallery - Vertical Swiper (Characters) -->
        <div class="explore-gallery-wrapper">
            <div class="swiper explore-vertical-swiper" id="characterSwiper">
                <div class="swiper-wrapper" id="characterSwiperWrapper">
                    <!-- Character slides will be loaded dynamically -->
                </div>
            </div>
            
            <!-- Loading State -->
            <div class="explore-loading" id="exploreLoading">
                <div class="loading-spinner"></div>
                <p>{{translations.loading}}</p>
            </div>
            
            <!-- Empty State -->
            <div class="explore-empty" id="exploreEmpty" style="display: none;">
                <i class="bi bi-search"></i>
                <h3>{{translations.no_results_found_for}}</h3>
                <p>{{translations.start_searching}}</p>
            </div>
        </div>



        <!-- Swipe Hint (shows on first visit) -->
        <div class="swipe-hint" id="swipeHint">
            <div class="swipe-hint-content">
                <div class="swipe-indicator horizontal">
                    <i class="bi bi-chevron-left"></i>
                    <span>Swipe for more images</span>
                    <i class="bi bi-chevron-right"></i>
                </div>
                <div class="swipe-indicator vertical">
                    <i class="bi bi-chevron-up"></i>
                    <span>Swipe for more characters</span>
                    <i class="bi bi-chevron-down"></i>
                </div>
            </div>
        </div>
    </div>

    {{> dashboard-footer}}

    <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="/js/character-infos.js"></script>

    <script>
        // Global configuration
        window.user = {
            _id: '{{user._id}}',
            subscriptionStatus: '{{user.subscriptionStatus}}',
            isTemporary: {{#if user.isTemporary}}true{{else}}false{{/if}},
            lang: '{{user.lang}}'
        };
        
        window.showNSFW = {{#if showNSFW}}true{{else}}false{{/if}};
        window.initialQuery = '{{query}}';
        
        window.translations = {
            loading: '{{translations.loading}}',
            no_results_found: '{{translations.no_results_found_for}}',
            try_different_search: '{{translations.start_searching}}'
        };
    </script>
    <script src="/js/explore-gallery.js"></script>
</body>
</html>
