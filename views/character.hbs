<!DOCTYPE html>
<html lang="ja">
       {{> dashboard-header}}
<body>
    {{> dashboard-nav}}

<style>

</style>
<div class="container mt-4">
  <div class="row mx-0">
    <!-- Chat Image Section -->
    {{#if image}}
    <div class="col-lg-8 mb-4">
      <div class="card border-0 shadow-0">
        <img src="{{#if isBlur}}{{imagePlaceholder }}{{else}}{{image.imageUrl}}{{/if}}" class="card-img-top" alt="{{image.prompt}}" style="max-height:400px;width:auto;object-fit:contain;">
        <div class="card-body border mt-3">
          <h5 class="card-title d-none">{{image.prompt}}</h5>
          <p class="card-text">{{image.comment}}</p>
          <p class="text-muted"><span class="jp-date">{{image.createdAt}}</span></p>
          <div class="d-flex justify-content-between align-items-center">
            <button class="btn btn-light shadow-0 image-fav {{#if  (includesObjectId image.likedBy user._id) }}liked{{/if}}" data-id="{{image._id}}">
              <i class="bi bi-heart-fill me-2"></i>{{translations.like}}<span class="ct d-none">{{default image.likes 0}}</span>
            </button>
            <a href="/chat/{{chat._id}}" class="btn btn-outline-secondary"> <i class="bi bi-chat-dots me-2"></i> {{translations.startChatting}}</a>
          </div>
        </div>
      </div>
    </div>
    {{/if}}
    {{#if chat}}
    <!-- Chat Profile Section -->
    <div class="col-lg-4 mb-4">
      <div class="card border shadow-0">
        <div class="card-body text-center">
          <div class="chat-profile mt-4">
            <div class="row mx-0 mb-3">
              <div id="chatProfileSection" class="text-center">
                <div class="mx-auto p-auto text-center d-flex align-items-center justify-content-center position-relative mb-2">
                  <a href="/chat/{{chat._id}}" class="text-secondary" style="text-decoration:none;">  
                    <img src="{{default chat.chatImageUrl '/img/avatar.png'}}" alt="Chat Thumbnail" class="rounded-circle" 
                    style="width: 100px; height: 100px; object-fit: cover; object-position: top;">
                  </a>
                </div>
                <a href="/chat/{{chat._id}}" class="text-secondary" style="text-decoration:none;">
                  <h2>{{chat.name}}</h2>
                </a>
                  <p>{{chat.description}}</p>
                <a href="/chat/{{chat._id}}" class="btn btn-outline-secondary"> <i class="bi bi-chat-dots me-2"></i>  {{translations.startChatting}}</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <h3 class="text-start">チャット中のユーザー</h3>
  <div class="container mt-4 mb-5">
    <!-- Chat Users Section -->
    <div id="chat-users-gallery" class="d-flex overflow-auto p-2" style="white-space: nowrap;"></div>
    <div id="chat-users-pagination-controls" class="mt-3"></div>
  </div>

  {{/if}}

  <!-- Other Images Section -->
  {{#if chatId}}
  <div class="container mb-5 px-0">
    <div class="row mx-0">
      <div class="col-12 mt-4 px-0">
        <h4>他の画像</h4>
        <hr>
        <div class="container-none">
          <div class="row mx-0" id="chat-images-gallery"></div>
          <div class="d-flex justify-content-center mt-4" id="chat-images-pagination-controls"></div>
        </div>
      </div>
    </div>
  </div>
</div>
{{else}}
 <h1 class="my-4 text-center">AIグラビアから送られてくる特別な写真</h1>
  <p>LamixでAIグラビアとチャットしていると、会話の中で魅力的な写真が次々と送られてきます。AIグラビアが送ってくれる写真は、まるで彼らの世界を垣間見るかのような美しいシーンばかり。まさにその瞬間に引き込まれるような体験を楽しみながら、キャラクターとの特別なひとときをお楽しみください。</p>
   
  <div class="container mt-4 mb-5">
    <div class="row mx-0" id="all-chats-images-gallery"></div>
    <div class="d-flex justify-content-center mt-4" id="all-chats-images-pagination-controls"></div>
    <button id="back-to-top" style="display: none;">トップに戻る</button>
  </div>
{{/if}}
<style>
  footer{display: inline !important;}
</style>
 {{> dashboard-footer}}


</body>
<script>
  $(document).ready(function () {
    const chatId =`{{chatId}}`
    if(chatId){
      loadChatImages(chatId, 1);
      loadChatUsers(chatId);
    }else{
      loadAllChatImages(1);
    }
  });
  </script>
</html>
